From 1ca0a801086ee9e40b72a88642a41c366be5825f Mon Sep 17 00:00:00 2001
From: wusel <wusel+src@uu.org>
Date: Sun, 16 Jun 2024 22:18:42 +0200
Subject: [PATCH] Adjust for FFGT maps

---
 package/gluon-respondd/src/respondd-nodeinfo.c | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/package/gluon-respondd/src/respondd-nodeinfo.c b/package/gluon-respondd/src/respondd-nodeinfo.c
index 53dd6524..cf9fb7c6 100644
--- a/package/gluon-respondd/src/respondd-nodeinfo.c
+++ b/package/gluon-respondd/src/respondd-nodeinfo.c
@@ -105,10 +105,13 @@ struct json_object * respondd_provider_nodeinfo(void) {
 	json_object_object_add(ret, "software", software);
 
 	struct json_object *system = json_object_new_object();
-	json_object_object_add(system, "site_code", get_site_code());
 	if (gluonutil_has_domains()) {
 		json_object_object_add(system, "domain_code", get_domain_code());
+		json_object_object_add(system, "gluon_site_code", get_site_code());
+		json_object_object_add(system, "site_code", get_domain_code());
 		json_object_object_add(system, "primary_domain_code", get_primary_domain_code());
+	} else {
+		json_object_object_add(system, "site_code", get_site_code());
 	}
 	json_object_object_add(ret, "system", system);
 
-- 
2.30.2

